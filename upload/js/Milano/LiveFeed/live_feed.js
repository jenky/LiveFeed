/* Jun 27, 2014 at 9:52 PM */

!function(a,b,c){XenForo.LiveFeed=function(a){this.__construct(a)},XenForo.LiveFeed.prototype={__construct:function(b){this.$element=b,a(c).bind("XFAjaxSuccess",a.context(this,"update")),a(c).bind("XenForoWindowFocus",a.context(this,"focus")),this.interval=parseInt(this.$element.data("pollinginterval"),10)||30,this.xhr=null,this.activate(!0)},focus:function(){this.active||this.activate(!0)},activate:function(c){return c&&this.update(),this.active=b.setInterval(a.context(this,"update"),1e3*this.interval)},loadNewsFeed:function(){return null===this.xhr&&(this.xhr=XenForo.ajax("index.php?recent-activity/",{live_feed:this.$element.data("newestitemid"),referer:this.$element.attr("href")},a.context(this,"display"),{error:!1,global:!1})),!1},display:function(b){if(this.xhr=null,XenForo.hasResponseError(b))return!1;if(b.newestItemId&&this.$element.data("newestitemid",b.newestItemId),XenForo.hasTemplateHtml(b)){var d=a(b.templateHtml),e=a("#newsFeedEmpty");d.length&&(e.length&&e.empty().remove(),d.xfInsert("prependTo",".newsFeed:first"))}},update:function(a){return XenForo._hasFocus||a?void this.loadNewsFeed():this.deactivate()},deactivate:function(){b.clearInterval(this.active),this.active=!1}},XenForo.register(".NewsFeedLoader","XenForo.LiveFeed")}(jQuery,this,document);